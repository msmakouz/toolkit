!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@spiral-toolkit/keeper",[],t):"object"==typeof exports?exports["@spiral-toolkit/keeper"]=t():e.SFKeeper=t()}(window,(function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=13)}([function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t),i.d(t,"on",(function(){return b})),i.d(t,"dispatch",(function(){return p}));i(0),i(1),i(2),i(3),i(4),i(5),i(6),i(7),i(8);class s{static init(){return new s(document.querySelector('[data-sf="nav"]'))}constructor(e){this.elem=e,this.elem&&(this.items={},this.handleToggleListeners={},this.elem.querySelectorAll('[data-sf="nav-item-toggle"]').forEach((e,t)=>{this.items[t]={index:t,toggleElem:e,contentElem:e.nextElementSibling,isExpanded:"true"===e.getAttribute("aria-expanded")},this.handleToggleListeners[t]=this.handleToggle.bind(this,t)}),this.init(),this.bind())}bind(){Object.values(this.items).forEach(e=>e.toggleElem.addEventListener("click",this.handleToggleListeners[e.index]))}handleToggle(e){this.items[e].isExpanded=!this.items[e].isExpanded,this.redraw(e),this.items[e].isExpanded&&Object.values(this.items).forEach(t=>{t.index!==e&&this.hide(t.index)})}toggle(e){this.items[e].isExpanded=!this.items[e].isExpanded,this.redraw(e)}hide(e){this.items[e].isExpanded&&(this.items[e].isExpanded=!1,this.redraw(e))}redraw(e){const{toggleElem:t,contentElem:i,isExpanded:s}=this.items[e];t.classList.toggle("active",s),t.setAttribute("aria-expanded",s?"true":"false"),i.style.maxHeight=s?`${i.scrollHeight}px`:null}init(){Object.values(this.items).forEach(e=>{this.redraw(e.index)})}}class n{static init(e){return new n(e)}constructor(e){this.elem=e,this.elem&&(this.toggleElem=e.querySelector('[data-sf="dropdown-toggle"]'),this.menuElem=e.querySelector('[data-sf="dropdown-menu"]'),this.toggleElem&&this.menuElem&&(this.isExpanded="true"===this.toggleElem.getAttribute("aria-expanded"),this.isExpanded&&this.redraw(),this.handleClickListener=this.handleClick.bind(this),this.handleInsideClickListener=this.handleInsideClick.bind(this),this.handleOutsideClickListener=this.handleOutsideClick.bind(this),this.isInnerClick=!1,this.bind()))}bind(){this.toggleElem.addEventListener("click",this.handleClickListener),this.elem.addEventListener("click",this.handleInsideClickListener),document.addEventListener("click",this.handleOutsideClickListener)}handleClick(){this.toggle()}handleInsideClick(){this.isInnerClick=!0}handleOutsideClick(){this.isInnerClick||this.hide(),this.isInnerClick=!1}toggle(){this.isExpanded=!this.isExpanded,this.redraw()}show(){this.isExpanded||(this.isExpanded=!0,this.redraw())}hide(){this.isExpanded&&(this.isExpanded=!1,this.redraw())}redraw(){this.toggleElem.setAttribute("aria-expanded",this.isExpanded),this.menuElem.classList.toggle("show",this.isExpanded)}}i(9);const l=e=>{const t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)};let h=!1;if("undefined"!=typeof window){const e={get passive(){h=!0}};window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}function d(){document.addEventListener("touchmove",l,h?{passive:!1}:void 0)}function o(){document.removeEventListener("touchmove",l,h?{passive:!1}:void 0)}class a{static init(){return new a(document.querySelector('[data-sf="sidebar"]'))}constructor(e){this.elem=e,this.elem&&(this.toggleElems=document.querySelectorAll('[data-sf="sidebar-toggle"]'),this.toggleElems.length&&(this.isMobile=!1,this.checkMobile(),this.isExpanded=!this.isMobile&&"true"===this.toggleElems[0].getAttribute("aria-expanded"),this.redraw(),this.handleClickListener=this.handleClick.bind(this),this.handleInsideClickListener=this.handleInsideClick.bind(this),this.handleOutsideClickListener=this.handleOutsideClick.bind(this),this.handleResizeListener=this.handleResize.bind(this),this.isInnerClick=!1,this.bind()))}bind(){this.toggleElems.forEach(e=>e.addEventListener("click",this.handleClickListener)),this.elem.addEventListener("click",this.handleInsideClickListener),document.addEventListener("click",this.handleOutsideClickListener),window.addEventListener("resize",this.handleResizeListener)}handleClick(){this.isInnerClick=!0,this.toggle()}handleInsideClick(){this.isInnerClick=!0}handleOutsideClick(){this.isMobile?(this.isInnerClick||this.hide(),this.isInnerClick=!1):this.isInnerClick=!1}handleResize(){this.checkMobile()}checkMobile(){const e=this.isMobile;window.matchMedia("(max-width: 768px)").matches?this.isMobile=!0:this.isMobile=!1,e!==this.isMobile&&this.isExpanded&&(this.isMobile?d():o())}toggle(){this.isExpanded=!this.isExpanded,this.redraw()}show(){this.isExpanded||(this.isExpanded=!0,this.redraw())}hide(){this.isExpanded&&(this.isExpanded=!1,this.redraw())}redraw(){this.toggleElems.forEach(e=>e.setAttribute("aria-expanded",this.isExpanded)),this.elem.classList.toggle("active",this.isExpanded),this.isMobile&&(this.isExpanded?d():o())}}i(10);class c{static init(e){return new c(e)}constructor(e){if(this.elem=e,!this.elem)return;if(this.id=this.elem.id,this.toggleElems=document.querySelectorAll(`[data-sf="modal-toggle"][data-target="${this.id}"]`),!this.toggleElems||!this.toggleElems.length)return;this.contentElem=e.querySelector('[data-sf="modal-content"]'),this.closeElem=e.querySelector('[data-sf="modal-close"]'),this.confirmElem=e.querySelector('[data-sf="modal-confirm"]'),this.cancelElem=e.querySelector('[data-sf="modal-cancel"]');const t=this.elem.getAttribute("aria-hidden");this.isOpened=!t||"true"!==t,this.isOpened&&this.redraw(),this.handleClickToggleListener=this.handleClickToggle.bind(this),this.handleClickCloseListener=this.handleClickClose.bind(this),this.handleClickConfirmListener=this.handleClickConfirm.bind(this),this.handleClickCancelListener=this.handleClickCancel.bind(this),this.handleInsideClickListener=this.handleInsideClick.bind(this),this.handleOutsideClickListener=this.handleOutsideClick.bind(this),this.isInnerClick=!1,this.openTimeout=!1,this.closeTimeout=!1,this.bind()}bind(){this.toggleElems.forEach(e=>e.addEventListener("click",this.handleClickToggleListener)),this.closeElem&&this.closeElem.addEventListener("click",this.handleClickCloseListener),this.confirmElem&&this.confirmElem.addEventListener("click",this.handleClickConfirmListener),this.cancelElem&&this.cancelElem.addEventListener("click",this.handleClickCancelListener),this.contentElem.addEventListener("click",this.handleInsideClickListener),document.addEventListener("click",this.handleOutsideClickListener)}handleClickToggle(){this.isInnerClick=!0,this.toggle()}handleClickClose(){this.close()}handleClickConfirm(){this.dispatch("sf:modal-confirm"),this.close()}handleClickCancel(){this.dispatch("sf:modal-cancel"),this.close()}handleInsideClick(){this.isInnerClick=!0}handleOutsideClick(){this.isInnerClick||this.close(),this.isInnerClick=!1}toggle(){this.isOpened=!this.isOpened,this.redraw()}open(){this.isOpened||(this.isOpened=!0,this.redraw())}close(){this.isOpened&&(this.isOpened=!1,this.redraw())}redraw(){this.openTimeout&&clearTimeout(this.openTimeout),this.closeTimeout&&clearTimeout(this.closeTimeout),this.isOpened?this.dispatch("sf:modal-show"):this.dispatch("sf:modal-hide"),this.elem.setAttribute("aria-hidden",!this.isOpened),this.elem.classList.toggle("show",this.isOpened),this.isOpened?this.openTimeout=setTimeout(()=>{document.body.classList.add("modal-open"),this.dispatch("sf:modal-shown")},300):(document.body.classList.remove("modal-open"),this.closeTimeout=setTimeout(()=>{this.dispatch("sf:modal-hidden")},300))}dispatch(e){const t=new CustomEvent(e);this.elem.dispatchEvent(t)}}i(11);class r{static init(e){return new r(e)}constructor(e){this.elem=e,this.elem&&(this.closeElem=e.querySelector('[data-sf="notification-close"]'),this.closeElem&&(this.handleClickCloseListener=this.handleClickClose.bind(this),this.closeTimeout=!1,this.bind()))}getElem(){return this.elem}bind(){this.closeElem.addEventListener("click",this.handleClickCloseListener)}unbind(){this.closeElem.removeEventListener("click",this.handleClickCloseListener)}handleClickClose(){this.unbind(),this.close()}close(){this.closeTimeout&&clearTimeout(this.closeTimeout),this.elem.classList.add("closing"),this.closeTimeout=setTimeout(()=>{this.elem.remove()},300)}}class u{static init(){return new u}constructor(){this.corners=["tl","tr","bl","br"],this.cornerElems={},this.handleShowNotificationListener=this.handleShowNotification.bind(this),this.initNotifications(),this.bind()}initNotifications(){const e={};document.querySelectorAll('[data-sf="notification"]').forEach(t=>{const i=t.getAttribute("data-position");i&&"inline"!==i&&this.corners.includes(i)?(e[i]||(e[i]=[]),e[i].push(new r(t))):r.init(t)}),this.corners.forEach(t=>{e[t]&&e[t].length&&this.createCorner(t,e[t])})}bind(){document.addEventListener("sf:notification-show",this.handleShowNotificationListener)}handleShowNotification(e){const{message:t,type:i,position:s}=e.detail,n=function(e,t="info"){const i=document.createElement("div");return i.classList.add("sf-notification","alert",`alert-${t}`,"alert-dismissible"),i.setAttribute("role","alert"),i.innerHTML=`${e}\n    <button type="button" class="close" data-sf="notification-close" aria-label="Close">\n      <span aria-hidden="true">&times;</span>\n    </button>`,i}(t,i),l=new r(n);this.appendNotification(s,l)}createCorner(e,t){const i=document.createElement("div");i.classList.add("sf-notification__corner",`sf-notification__corner--${e}`),document.body.appendChild(i),this.cornerElems[e]=i,t.forEach(t=>this.appendNotification(e,t))}appendNotification(e,t){this.cornerElems[e].appendChild(t.getElem())}}class m{constructor(e){this.elem=e,this.elem&&(this.contentId=this.elem.getAttribute("aria-controls"),this.contentElem=document.getElementById(this.contentId),this.contentElem&&(this.isVisible="true"===this.elem.getAttribute("aria-selected"),this.isVisible&&this.redraw(),this.showCallback=!1,this.handleClickListener=this.handleClick.bind(this),this.bind()))}bind(){this.elem.addEventListener("click",this.handleClickListener)}handleClick(){this.show()}getContentId(){return this.contentId}show(){this.isVisible||(this.isVisible=!0,this.redraw(),this.showCallback&&this.showCallback(this.contentId))}onShow(e){this.showCallback=e}hide(){this.isVisible&&(this.isVisible=!1,this.redraw())}redraw(){this.elem.setAttribute("aria-selected",this.isVisible),this.elem.classList.toggle("active",this.isVisible),this.contentElem.classList.toggle("active",this.isVisible)}}i(12);class f{static init(e){return new f(e)}constructor(e){this.elem=e,this.elem&&(this.tabs=[],this.elem.querySelectorAll('[data-sf="tabnav-tab"]').forEach(e=>{this.tabs.push(new m(e))}),this.handleShowListener=this.handleShow.bind(this),this.bind())}bind(){this.tabs.forEach(e=>e.onShow(this.handleShowListener))}handleShow(e){this.tabs.forEach(t=>{e!==t.getContentId()&&t.hide()})}}const E="function"==typeof window.CustomEvent?function(e,t,i,s){return new CustomEvent(e,{bubbles:i,cancelable:s,detail:t})}:function(e,t,i,s){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,i,s,t),n};function b(e,t,i,s=!1){let n=e;return"string"==typeof e&&(n=document.getElementById(e)),n?(n.addEventListener(t,i,s),()=>n.removeEventListener(t,i,s)):null}function p(e,t,i={},s={bubbles:!0,cancelable:!0}){const n=s.bubbles||!0,l=s.cancelable||!0,h=E(t,i,n,l);return e.dispatchEvent(h)}document.addEventListener("DOMContentLoaded",()=>{u.init(),document.querySelectorAll('[data-sf="dropdown"]').forEach(e=>n.init(e)),document.querySelectorAll('[data-sf="modal"]').forEach(e=>c.init(e)),document.querySelectorAll('[data-sf="tabnav"]').forEach(e=>f.init(e)),s.init(),a.init()})}])}));
//# sourceMappingURL=keeper.js.map